#!/usr/bin/env bash
# Check if a file is provided as an argument
if [ "$#" -ne 1 ]; then
    echo "Usage: \$0 <apache_log_file>"
    exit 1
fi

# AWK script to count occurrences of IP and HTTP status code
awk '{
    # Assuming the log format is standard with IP as the first field and status code as the 9th field
    ip = $1;
    status = $9;
    # Concatenate IP and status code as a key
    key = ip " " status;
    # Count occurrences
    count[key]++;
} END {
    # Iterate through the counts and print
    for (key in count) {
        print count[key] " " key;
    }
}' "$1" | sort -r 
